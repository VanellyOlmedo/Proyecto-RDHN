{% extends 'core/base.html' %}

{% block title %}Detalle Movimiento - Fondo Mutuo{% endblock %}

{% block content %}
<div class="content-header">
    <h1 class="content-title">üìù Comprobante de Movimiento</h1>
    <div class="breadcrumb">
        <span class="breadcrumb-item"><a href="{% url 'fondo_mutuo:movimientos_listar' %}">Movimientos</a></span>
        <span class="breadcrumb-item">{{ movimiento.numero_movimiento }}</span>
    </div>
</div>

<div class="grid grid-2" style="align-items: start;">
    <!-- Informaci√≥n Principal -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üìÑ Informaci√≥n del Movimiento</h2>
            <div>
                {% if movimiento.origen == 'INGRESO' %}
                    <span class="badge badge-success">{{ movimiento.get_origen_display }}</span>
                {% elif movimiento.origen == 'EGRESO' %}
                    <span class="badge badge-error">{{ movimiento.get_origen_display }}</span>
                {% else %}
                    <span class="badge badge-info">{{ movimiento.get_origen_display }}</span>
                {% endif %}
            </div>
        </div>
        
        <div class="card-body">
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">N√öMERO DE COMPROBANTE</strong>
                    <p style="font-size: 24px; margin-top: 5px; color: var(--color-secondary); font-weight: bold;">
                        {{ movimiento.numero_movimiento }}
                    </p>
                </div>
                
                <div class="grid grid-2">
                    <div>
                        <strong style="color: var(--color-text-dim); font-size: 12px;">FECHA Y HORA</strong>
                        <p style="font-size: 16px; margin-top: 5px;">
                            {{ movimiento.fecha_movimiento|date:"d/m/Y H:i:s" }}
                        </p>
                    </div>
                    <div>
                        <strong style="color: var(--color-text-dim); font-size: 12px;">PER√çODO</strong>
                        <p style="font-size: 16px; margin-top: 5px;">
                            {{ movimiento.fondo }}
                        </p>
                    </div>
                </div>
                
                {% if movimiento.socio %}
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">SOCIO</strong>
                    <p style="font-size: 16px; margin-top: 5px;">
                        {{ movimiento.socio.nombre_completo }}
                    </p>
                    <p style="font-size: 14px; color: var(--color-text-dim); margin-top: 3px;">
                        No. Socio: {{ movimiento.socio.numero_socio }}
                    </p>
                </div>
                {% endif %}
                
                {% if movimiento.tipo_aporte %}
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">TIPO DE APORTE</strong>
                    <p style="font-size: 16px; margin-top: 5px;">
                        {{ movimiento.get_tipo_aporte_display }}
                    </p>
                </div>
                {% endif %}
                
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">CONCEPTO</strong>
                    <p style="font-size: 16px; margin-top: 5px;">
                        {{ movimiento.concepto }}
                    </p>
                </div>
                
                {% if movimiento.observaciones %}
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">OBSERVACIONES</strong>
                    <p style="font-size: 14px; margin-top: 5px;">
                        {{ movimiento.observaciones }}
                    </p>
                </div>
                {% endif %}
                
                <div>
                    <strong style="color: var(--color-text-dim); font-size: 12px;">REALIZADO POR</strong>
                    <p style="font-size: 16px; margin-top: 5px;">
                        {{ movimiento.realizado_por.get_full_name|default:movimiento.realizado_por.usuario }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Informaci√≥n Financiera -->
    <div>
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">üí∞ Informaci√≥n Financiera</h2>
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <div style="text-align: center; padding: 20px; background: rgba(69, 162, 158, 0.1); border-radius: var(--radius-md);">
                        <strong style="color: var(--color-text-dim); font-size: 14px;">MONTO</strong>
                        <p style="font-size: 48px; margin-top: 10px; font-weight: bold; 
                           {% if movimiento.origen == 'INGRESO' %}color: var(--color-success);{% else %}color: var(--color-error);{% endif %}">
                            {% if movimiento.origen == 'INGRESO' %}+{% else %}-{% endif %}L. {{ movimiento.monto|floatformat:2 }}
                        </p>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid rgba(69, 162, 158, 0.2);">
                        <span style="color: var(--color-text-dim);">Saldo Anterior:</span>
                        <span style="font-size: 18px; font-weight: bold;">
                            L. {{ movimiento.saldo_anterior|floatformat:2 }}
                        </span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; padding: 15px 0;">
                        <span style="color: var(--color-text-dim); font-weight: 600;">Saldo Nuevo:</span>
                        <span style="font-size: 22px; font-weight: bold; color: var(--color-secondary);">
                            L. {{ movimiento.saldo_nuevo|floatformat:2 }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        {% if movimiento.solicitud_ayuda %}
        <div class="card" style="margin-top: 20px;">
            <div class="card-header">
                <h2 class="card-title">üìã Solicitud Relacionada</h2>
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div>
                        <strong style="color: var(--color-text-dim);">N√∫mero de Solicitud:</strong>
                        <p style="margin-top: 5px;">{{ movimiento.solicitud_ayuda.numero_solicitud }}</p>
                    </div>
                    <div>
                        <strong style="color: var(--color-text-dim);">Tipo de Ayuda:</strong>
                        <p style="margin-top: 5px;">{{ movimiento.solicitud_ayuda.get_tipo_ayuda_display }}</p>
                    </div>
                    <a href="{% url 'fondo_mutuo:solicitudes_detalle' movimiento.solicitud_ayuda.pk %}" class="btn btn-sm btn-primary" style="margin-top: 10px;">
                        Ver Solicitud Completa
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- Botones de Acci√≥n -->
<div style="display: flex; gap: 10px; margin-top: 30px; justify-content: center;">
    <a href="{% url 'fondo_mutuo:movimientos_imprimir' movimiento.pk %}" class="btn btn-primary" target="_blank">
        <span>üñ®Ô∏è</span> Imprimir Comprobante
    </a>
    <a href="{% url 'fondo_mutuo:movimientos_listar' %}" class="btn">
        <span>‚óÄÔ∏è</span> Volver al Listado
    </a>
</div>
{% endblock %}