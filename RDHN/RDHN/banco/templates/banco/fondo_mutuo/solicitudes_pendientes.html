{% extends 'core/base.html' %}

{% block title %}Solicitudes Pendientes - Fondo Mutuo{% endblock %}

{% block content %}
<div class="content-header">
    <h1 class="content-title">‚è≥ Solicitudes Pendientes de Revisi√≥n</h1>
    <div class="breadcrumb">
        <span class="breadcrumb-item"><a href="{% url 'fondo_mutuo:solicitudes_listar' %}">Solicitudes</a></span>
        <span class="breadcrumb-item">Pendientes</span>
    </div>
</div>

<div class="alert alert-warning">
    <span>‚ö†</span>
    <div>
        <strong>{{ solicitudes.count }} solicitud(es) pendiente(s) de revisi√≥n</strong>
        <p>Estas solicitudes requieren tu atenci√≥n para aprobarlas o rechazarlas.</p>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Solicitudes por Revisar</h2>
        <a href="{% url 'fondo_mutuo:solicitudes_listar' %}" class="btn btn-sm">
            Ver Todas las Solicitudes
        </a>
    </div>
    
    <div class="card-body">
        {% if solicitudes %}
        <div style="display: flex; flex-direction: column; gap: 20px;">
            {% for sol in solicitudes %}
            <div class="card {% if sol.estado == 'PENDIENTE' %}border-warning{% else %}border-info{% endif %}">
                <div class="card-body">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
                        <div>
                            <h3 style="color: var(--color-secondary); margin-bottom: 5px;">
                                {{ sol.numero_solicitud }}
                            </h3>
                            <p style="color: var(--color-text-dim); font-size: 14px;">
                                Solicitada el {{ sol.fecha_solicitud|date:"d/m/Y" }}
                                {% if sol.creado_por %}
                                    por {{ sol.creado_por.get_full_name|default:sol.creado_por.usuario }}
                                {% endif %}
                            </p>
                        </div>
                        <div style="text-align: right;">
                            {% if sol.estado == 'PENDIENTE' %}
                                <span class="badge badge-warning">{{ sol.get_estado_display }}</span>
                            {% else %}
                                <span class="badge badge-info">{{ sol.get_estado_display }}</span>
                            {% endif %}
                            <span class="badge badge-info" style="margin-top: 5px; display: block;">
                                {{ sol.get_tipo_ayuda_display }}
                            </span>
                        </div>
                    </div>
                    
                    <div class="grid grid-2" style="margin-bottom: 20px;">
                        <div>
                            <strong style="color: var(--color-text-dim); font-size: 12px;">SOCIO</strong>
                            <p style="font-size: 16px; margin-top: 5px;">
                                {{ sol.socio.nombre_completo }}
                            </p>
                            <p style="font-size: 13px; color: var(--color-text-dim); margin-top: 3px;">
                                No. Socio: {{ sol.socio.numero_socio }}
                            </p>
                        </div>
                        
                        <div>
                            <strong style="color: var(--color-text-dim); font-size: 12px;">MONTO SOLICITADO</strong>
                            <p style="font-size: 24px; margin-top: 5px; color: var(--color-secondary); font-weight: bold;">
                                L. {{ sol.monto_solicitado|floatformat:2 }}
                            </p>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong style="color: var(--color-text-dim); font-size: 12px;">JUSTIFICACI√ìN</strong>
                        <p style="font-size: 14px; margin-top: 5px; line-height: 1.6;">
                            {{ sol.justificacion|truncatewords:30 }}
                        </p>
                    </div>
                    
                    {% if sol.documento_soporte %}
                    <div style="margin-bottom: 20px;">
                        <strong style="color: var(--color-text-dim); font-size: 12px;">DOCUMENTO SOPORTE</strong>
                        <p style="margin-top: 5px;">
                            <a href="{{ sol.documento_soporte.url }}" target="_blank" class="btn btn-sm">
                                üìé Ver Documento
                            </a>
                        </p>
                    </div>
                    {% endif %}
                    
                    <div style="display: flex; gap: 10px; padding-top: 20px; border-top: 1px solid rgba(69, 162, 158, 0.2);">
                        <a href="{% url 'fondo_mutuo:solicitudes_detalle' sol.pk %}" class="btn btn-sm">
                            üëÅÔ∏è Ver Detalles
                        </a>
                        <a href="{% url 'fondo_mutuo:solicitudes_aprobar' sol.pk %}" class="btn btn-sm btn-success">
                            ‚úì Aprobar
                        </a>
                        <a href="{% url 'fondo_mutuo:solicitudes_rechazar' sol.pk %}" class="btn btn-sm btn-error">
                            ‚úï Rechazar
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div style="text-align: center; padding: 60px 20px;">
            <div style="font-size: 64px; margin-bottom: 20px;">‚úì</div>
            <h3 style="color: var(--color-secondary); margin-bottom: 10px;">
                ¬°Excelente! No hay solicitudes pendientes
            </h3>
            <p style="color: var(--color-text-dim);">
                Todas las solicitudes han sido revisadas.
            </p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}