{% extends 'core/base.html' %}

{% block title %}Dashboard - Sistema de Gestión{% endblock %}

{% block content %}
<div class="content-header">
    <h1 class="content-title">📊 Dashboard General</h1>
    <div class="breadcrumb">
        <span class="breadcrumb-item">Inicio</span>
        <span class="breadcrumb-separator">›</span>
        <span class="breadcrumb-item active">Dashboard</span>
    </div>
</div>

<!-- Saludo y Fecha -->
<div class="card" style="margin-bottom: 30px; background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);">
    <div class="card-body" style="padding: 25px;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
            <div>
                <h2 style="color: white; margin: 0 0 8px 0; font-size: 1.8rem;">
                    👋 Bienvenido, {{ user.get_full_name }}
                </h2>
                <p style="color: rgba(255,255,255,0.9); margin: 0; font-size: 1rem;">
                    {% now "l, j \d\e F \d\e Y" %}
                </p>
            </div>
            <div style="text-align: right;">
                <p style="color: rgba(255,255,255,0.8); margin: 0 0 5px 0; font-size: 0.9rem;">
                    Usuario: <strong style="color: white;">{{ user.usuario }}</strong>
                </p>
                {% if user.ultimo_acceso %}
                <p style="color: rgba(255,255,255,0.8); margin: 0; font-size: 0.9rem;">
                    Último acceso: {{ user.ultimo_acceso|date:"d/m/Y H:i" }}
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Estadísticas Generales -->
<div style="margin-bottom: 30px;">
    <h3 style="margin-bottom: 20px; color: var(--color-text); font-size: 1.3rem;">
        📈 Resumen General
    </h3>
    <div class="grid grid-4">
        <div class="card card-stat" style="border-left: 4px solid #3b82f6;">
            <div class="card-stat-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">👥</div>
            <div class="card-stat-value">{{ total_socios|default:"0" }}</div>
            <div class="card-stat-label">Socios Registrados</div>
            <a href="{% url 'core:socios_listar' %}" class="btn btn-sm" style="margin-top: 12px;">
                Ver todos →
            </a>
        </div>
        
        <div class="card card-stat" style="border-left: 4px solid #10b981;">
            <div class="card-stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">💰</div>
            <div class="card-stat-value">{{ total_cuentas|default:"0" }}</div>
            <div class="card-stat-label">Cuentas de Ahorro</div>
            <a href="{% url 'banco:cuentas_listar' %}" class="btn btn-sm" style="margin-top: 12px;">
                Ver todas →
            </a>
        </div>
        
        <div class="card card-stat" style="border-left: 4px solid #f59e0b;">
            <div class="card-stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">💸</div>
            <div class="card-stat-value">{{ total_transacciones|default:"0" }}</div>
            <div class="card-stat-label">Transacciones</div>
            <a href="{% url 'banco:transacciones_listar' %}" class="btn btn-sm" style="margin-top: 12px;">
                Ver todas →
            </a>
        </div>
        
        <div class="card card-stat" style="border-left: 4px solid #8b5cf6;">
            <div class="card-stat-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">🤝</div>
            <div class="card-stat-value">{{ total_solicitudes|default:"0" }}</div>
            <div class="card-stat-label">Solicitudes Fondo</div>
            <a href="{% url 'fondo_mutuo:solicitudes_listar' %}" class="btn btn-sm" style="margin-top: 12px;">
                Ver todas →
            </a>
        </div>
    </div>
</div>

<!-- Módulos del Sistema -->
<div style="margin-bottom: 30px;">
    <h3 style="margin-bottom: 20px; color: var(--color-text); font-size: 1.3rem;">
        🚀 Accesos Rápidos por Módulo
    </h3>
    <div class="grid grid-3">
        <!-- Módulo Banco -->
        <div class="card">
            <div class="card-header" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 20px;">
                <h2 class="card-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">🏦</span>
                    <span>Módulo Banco</span>
                </h2>
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <a href="{% url 'banco:cuentas_crear' %}" class="btn btn-block">
                        <span>➕</span> Nueva Cuenta
                    </a>
                    <a href="{% url 'banco:cuentas_listar' %}" class="btn btn-block btn-secondary">
                        <span>💰</span> Ver Cuentas
                    </a>
                    <a href="{% url 'banco:transacciones_listar' %}" class="btn btn-block btn-secondary">
                        <span>💸</span> Transacciones
                    </a>
                    <a href="{% url 'banco:periodos_listar' %}" class="btn btn-block btn-secondary">
                        <span>📊</span> Períodos Dividendos
                    </a>
                </div>
            </div>
        </div>

        <!-- Módulo Fondo Mutuo -->
        <div class="card">
            <div class="card-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 20px;">
                <h2 class="card-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">🤝</span>
                    <span>Fondo Mutuo</span>
                </h2>
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <a href="{% url 'fondo_mutuo:aportes_crear' %}" class="btn btn-block">
                        <span>➕</span> Registrar Aporte
                    </a>
                    <a href="{% url 'fondo_mutuo:solicitudes_crear' %}" class="btn btn-block">
                        <span>📝</span> Nueva Solicitud
                    </a>
                    <a href="{% url 'fondo_mutuo:solicitudes_pendientes' %}" class="btn btn-block btn-secondary">
                        <span>⏳</span> Solicitudes Pendientes
                    </a>
                    <a href="{% url 'fondo_mutuo:dashboard' %}" class="btn btn-block btn-secondary">
                        <span>📊</span> Dashboard Fondo
                    </a>
                </div>
            </div>
        </div>

        <!-- Gestión General -->
        <div class="card">
            <div class="card-header" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; padding: 20px;">
                <h2 class="card-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">⚙️</span>
                    <span>Gestión General</span>
                </h2>
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <a href="{% url 'core:socios_crear' %}" class="btn btn-block">
                        <span>➕</span> Nuevo Socio
                    </a>
                    <a href="{% url 'core:usuarios_crear' %}" class="btn btn-block">
                        <span>👤</span> Nuevo Usuario
                    </a>
                    <a href="{% url 'core:expedientes_crear' %}" class="btn btn-block">
                        <span>📂</span> Nuevo Expediente
                    </a>
                    <a href="{% url 'core:roles_listar' %}" class="btn btn-block btn-secondary">
                        <span>🔐</span> Gestionar Roles
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Información Adicional y Reportes -->
<div class="grid grid-2">
    <!-- Estadísticas Adicionales -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">📊 Estadísticas del Sistema</h2>
        </div>
        <div class="card-body">
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--color-surface); border-radius: 8px;">
                    <span style="color: var(--color-text-dim);">👤 Usuarios Activos</span>
                    <strong style="color: var(--color-primary); font-size: 1.2rem;">{{ total_usuarios|default:"0" }}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--color-surface); border-radius: 8px;">
                    <span style="color: var(--color-text-dim);">📂 Expedientes</span>
                    <strong style="color: var(--color-primary); font-size: 1.2rem;">{{ total_expedientes|default:"0" }}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--color-surface); border-radius: 8px;">
                    <span style="color: var(--color-text-dim);">🔐 Roles Activos</span>
                    <strong style="color: var(--color-primary); font-size: 1.2rem;">{{ total_roles|default:"0" }}</strong>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--color-surface); border-radius: 8px;">
                    <span style="color: var(--color-text-dim);">🔔 Notificaciones</span>
                    <strong style="color: var(--color-warning); font-size: 1.2rem;">{{ total_notificaciones|default:"0" }}</strong>
                </div>
            </div>
        </div>
    </div>

    <!-- Accesos Rápidos a Reportes -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">📑 Reportes y Consultas</h2>
        </div>
        <div class="card-body">
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <a href="{% url 'fondo_mutuo:reportes_kardex' %}" class="btn btn-block">
                    <span>📊</span> Reporte Kardex
                </a>
                <a href="{% url 'fondo_mutuo:movimientos_listar' %}" class="btn btn-block btn-secondary">
                    <span>📝</span> Movimientos Fondo
                </a>
                <a href="{% url 'banco:transacciones_listar' %}" class="btn btn-block btn-secondary">
                    <span>💸</span> Historial Transacciones
                </a>
                <a href="{% url 'banco:notificaciones_listar' %}" class="btn btn-block btn-secondary">
                    <span>🔔</span> Ver Notificaciones
                </a>
                <a href="{% url 'core:socios_listar' %}" class="btn btn-block btn-secondary">
                    <span>👥</span> Listado de Socios
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Mensaje de ayuda -->
<div class="card" style="margin-top: 30px; border-left: 4px solid var(--color-info);">
    <div class="card-body" style="padding: 20px;">
        <div style="display: flex; align-items: start; gap: 15px;">
            <div style="font-size: 2rem;">💡</div>
            <div>
                <h3 style="margin: 0 0 8px 0; color: var(--color-text);">
                    Tip: Navegación Rápida
                </h3>
                <p style="margin: 0; color: var(--color-text-dim); line-height: 1.6;">
                    Utiliza el menú lateral para acceder a todas las funcionalidades del sistema. 
                    Puedes navegar entre los módulos de Banco, Fondo Mutuo y Gestión General. 
                    Las tarjetas superiores te muestran un resumen del estado actual del sistema.
                </p>
            </div>
        </div>
    </div>
</div>

<style>
/* Estilos adicionales para el dashboard */
.card-stat {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card-stat:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}

.btn-block {
    width: 100%;
    text-align: center;
    padding: 12px 20px;
    transition: all 0.2s ease;
}

.btn-block:hover {
    transform: translateX(5px);
}

.btn-secondary {
    background: var(--color-surface);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-secondary:hover {
    background: var(--color-border);
}

@media (max-width: 768px) {
    .grid-4 {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .grid-3, .grid-2 {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}